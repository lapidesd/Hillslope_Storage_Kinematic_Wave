# Laboratory experiments: supplementary code and data

This directory contains code and data related to laboratory validation of analytical solutions to the kinematic wave equation on hillslopes with an exponential width function, as described by Lapides et al. (2020). Rainfall-runoff experiments were conducted on engineered hillslopes produced by CNC fabrication. Hillslopes exhibit exponential width functions, and surfaces are treated with sand. A rainfall simulator was constructed using atomizing spray nozzles for these experiments. Included material is as follows:

* raw_data.xlsx: an Excel spreadsheet containing mass-time data collected from each experimental run. Data during rainfall are marked in bold, and problematic values where experimental error was observed are highlighted in red. Runs are sorted by value of a (a=0.05 is divergent, a=0 is planar, and a=-0.05 is convergent).
* Hillslope_Smoothing.ipynb: a jupyter notebook file that describes the smoothing methods tested in Lapides et al. (2020) and walks through the analysis required to determine the optimal smoothing method. This notebook produces smoothed hydrograph data appropriate for comparison to analytical solutions.
* smooth_hydrograph_data.csv: a csv file containing flow-time data as the output from Hillslope_Smoothing.ipynb. These data all start from the time that the rainfall simulator is turned on.
* Experimental_analysis.ipynb: a jupyter notebok file that visualizes smoothed hydrographs and walks through the analysis required to compare analytical and experimental hydrographs. The rising limb, peak flow, and falling limb portions of the hydrograph are considered independent for data analysis. Peak flow is identified from each experimental hydrograph. Given mass balance (Q=AI, flow at the outlet is given by contributing area multiplied by rainfall intensity in the absence of losses) and the area of the hillslope, we calculate I required to produce the peak flow. The rainfall simulator is too spatial nonuniform to directly measure I. Then, we run a suite of analytical simulations for each experimental run at the given parameterized I value and a range of roughness values (alpha). The optimal alpha is chosen by taking the simulation for which the RMSE between the analytical simulation and the experimental run is minimized in the falling limb. We then chose a characteristic alpha for each hillslope (a=0.05, a=0, and a=-0.05) as the average for each hillslope since alpha should be a hillslope property. To evaluate fit, we used RMSE between rising limbs normalized by peak flow. We then demonstrate that when curvature is included in the analytical model, the fit statistics are much more robust.

Dependencies for jupyter notebooks are included in the first cell. Notebooks should be run in consecutive order for optimal results. Notebooks require the user to input the path to the downloaded data file.
